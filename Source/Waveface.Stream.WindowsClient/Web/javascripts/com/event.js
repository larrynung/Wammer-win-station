(function(){var e={}.hasOwnProperty,t=function(t,n){function i(){this.constructor=t}for(var r in n)e.call(n,r)&&(t[r]=n[r]);return i.prototype=n.prototype,t.prototype=new i,t.__super__=n.prototype,t},n=function(e,t){return function(){return e.apply(t,arguments)}};define(["jquery","underscore","backbone","localstorage"],function(e,r,i,s){var o,u,a;return window.dispatch=r.extend(i.Events),a={},u=function(){function e(e,t){t==null&&(t=!1),this.register(e,t)}return e.dispatch=window.dispatch,e.container=e.dispatch,e.bind=function(t,n){return e.container.on(t,n)},e.trigger=function(t,n){return e.container.trigger(t,n)},e.prototype.register=function(e,t){var n;t==null&&(t=!1);if(!Array.isArray(e)){n=new a[e](t);return}return r.each(e,function(e){return n=new a[e](t)}),!0},e}.call(this),o=function(){function e(){this.bind()}return e.dispatch=window.dispatch,e.prototype.bind=function(){return this.clear(),e.dispatch.on(this.eventName,this.callback)},e.prototype.clear=function(t){var n;return n=t||this.eventName,Logger.log("Clear Dispatch: "+n),e.dispatch.off(n),Logger.log("Event Binded: "+n)},e}(),a.WebSocketOpen=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.eventName="WebSocketOpen",n.prototype.callback=function(e){return Logger.log(""+new Date+" Web Socket Connection is open in "+e.getUri()+" from "+e.getName()),wfwsocket.sendMessage("getUserInfo")},n}(o),a.GetSessionToken=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.eventName="getSessionToken",n.prototype.callback=function(e){var t;return t=new s("nc_session_token"),t.data=e.response.sessionToken,t.save()},n}(o),a.GetUserInfo=function(e){function n(){return n.__super__.constructor.apply(this,arguments)}return t(n,e),n.prototype.eventName="getUserInfo",n.prototype.callback=function(e){var t;return console.log("callback getUserInfo"),t=new s("nc_user_info"),t.data=e.response,t.save(),o.dispatch.trigger("user:info:save",e)},n}(o),a.GetPosts=function(e){function r(e){this.postTarget=e,this.callback=n(this.callback,this),this.bind(this.postTarget)}return t(r,e),r.prototype.eventName="getPosts",r.prototype.postTarge=!1,r.prototype.bind=function(e){var t;return t=""+this.eventName+":"+e,this.clear(t),o.dispatch.on(t,this.callback),Logger.log("Bundler event : "+this.eventName+":"+e+", callback:"+this.callback)},r.prototype.callback=function(e){return o.dispatch.trigger("store:change:posts:"+this.postTarget,e.response,e.memo.namespace)},r}(o),a.GetAttachments=function(e){function r(e){this.attachmentTarget=e,this.callback=n(this.callback,this),this.bind(this.attachmentTarget)}return t(r,e),r.prototype.eventName="getAttachments",r.prototype.attachmentTarget=!1,r.prototype.bind=function(e){var t;return t=""+this.eventName+":"+e,this.clear(t),o.dispatch.on(t,this.callback),Logger.log("Bundler event : "+this.eventName+":"+e+", callback:"+this.callback)},r.prototype.callback=function(e){return dispatch.trigger("store:change:attachment:"+this.attachmentTarget,e.response,e.memo.namespace)},r}(o),a.SubscribeEvent=function(e){function n(e){this.target=e,this.bind(this.target)}return t(n,e),n.prototype.eventName="subscribeEvent",n.prototype.bind=function(e){var t;return t=""+this.eventName+":"+e,this.clear(t),o.dispatch.on(t,this.callback,this)},n.prototype.callback=function(e){return dispatch.trigger("subscribe:change:"+this.target,e)},n}(o),u})}).call(this);